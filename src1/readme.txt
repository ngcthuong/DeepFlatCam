Training code for Phase 1